<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ ‡∏™‡∏Å‡∏£.</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&family=Prompt:wght@300;400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #1a5f7a;
            --primary-light: #2e86ab;
            --primary-dark: #0d3d4f;
            --accent: #e65100;
            --accent-light: #ff8a50;
            --success: #2e7d32;
            --success-light: #4caf50;
            --selected-bg: #c8e6c9;
            --selected-border: #2e7d32;
            --bg-cream: #faf6f0;
            --bg-white: #ffffff;
            --text-dark: #1a1a1a;
            --text-muted: #666666;
            --border: #e0d5c7;
            --shadow: rgba(26, 95, 122, 0.12);
            --category-food-savory: #bf360c;
            --category-food-sweet: #ad1457;
            --category-development: #1565c0;
            --category-craft: #4a148c;
            --category-agriculture: #2e7d32;
            --category-health: #00838f;
            --category-custom: #78909c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Prompt', 'Kanit', sans-serif;
            background: linear-gradient(135deg, var(--bg-cream) 0%, #f5efe6 100%);
            min-height: 100vh;
            color: var(--text-dark);
        }

        .header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 20px 32px;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px var(--shadow);
        }

        .header-content {
            max-width: 1600px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header h1 {
            font-family: 'Kanit', sans-serif;
            font-size: 1.6rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header h1::before {
            content: "üìã";
            font-size: 1.4rem;
        }

        .header-stats {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .stat-badge {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .stat-badge strong {
            font-size: 1.15rem;
            color: var(--accent-light);
        }

        .center-select {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .center-select label {
            font-weight: 500;
            font-size: 0.9rem;
        }

        .center-select select {
            padding: 10px 16px;
            border-radius: 8px;
            border: none;
            font-family: inherit;
            font-size: 0.9rem;
            background: white;
            color: var(--text-dark);
            cursor: pointer;
            min-width: 180px;
        }

        .main-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 20px;
            display: grid;
            grid-template-columns: 340px 1fr;
            gap: 20px;
            min-height: calc(100vh - 100px);
        }

        .left-panel {
            background: var(--bg-white);
            border-radius: 16px;
            box-shadow: 0 8px 32px var(--shadow);
            padding: 20px;
            position: sticky;
            top: 100px;
            height: fit-content;
            max-height: calc(100vh - 130px);
            overflow-y: auto;
            border: 1px solid var(--border);
        }

        .panel-title {
            font-family: 'Kanit', sans-serif;
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 16px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .panel-title::before {
            content: "üèÜ";
        }

        .instructions {
            background: linear-gradient(135deg, rgba(46, 134, 171, 0.08) 0%, rgba(46, 134, 171, 0.03) 100%);
            border: 1px solid rgba(46, 134, 171, 0.2);
            border-radius: 10px;
            padding: 12px 14px;
            margin-bottom: 16px;
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .instructions strong {
            color: var(--primary);
        }

        .instructions ul {
            margin-top: 6px;
            padding-left: 18px;
        }

        .instructions li {
            margin-bottom: 3px;
        }

        .ranking-list {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .ranking-slot {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 12px;
            background: #f8f5f0;
            border-radius: 8px;
            border: 2px dashed var(--border);
            min-height: 46px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .ranking-slot.filled {
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
            border: none;
            color: white;
            box-shadow: 0 3px 10px rgba(46, 134, 171, 0.3);
        }

        .ranking-slot.drag-over {
            border-color: var(--accent);
            background: rgba(230, 81, 0, 0.1);
            transform: scale(1.02);
        }

        .ranking-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .ranking-slot.filled .ranking-number {
            background: rgba(255,255,255,0.25);
        }

        .ranking-slot:nth-child(-n+3) .ranking-number {
            background: var(--accent);
        }

        .ranking-slot.filled:nth-child(-n+3) .ranking-number {
            background: rgba(255,255,255,0.3);
        }

        .ranking-content {
            flex: 1;
            font-size: 0.85rem;
            color: var(--text-muted);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .ranking-slot.filled .ranking-content {
            color: white;
            font-weight: 500;
        }

        .ranking-remove {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .ranking-slot.filled .ranking-remove {
            display: flex;
        }

        .ranking-remove:hover {
            background: rgba(255,0,0,0.5);
            transform: scale(1.1);
        }

        .right-panel {
            background: var(--bg-white);
            border-radius: 16px;
            box-shadow: 0 8px 32px var(--shadow);
            padding: 20px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 16px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 12px 18px 12px 44px;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-family: inherit;
            font-size: 0.95rem;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(46, 134, 171, 0.15);
        }

        .search-box::before {
            content: "üîç";
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
        }

        .category-tabs {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .category-tab {
            padding: 8px 14px;
            border-radius: 50px;
            border: 2px solid var(--border);
            background: white;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.8rem;
            font-weight: 500;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .category-tab:hover {
            border-color: var(--primary);
            background: rgba(46, 134, 171, 0.05);
        }

        .category-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .category-tab .count {
            background: rgba(0,0,0,0.1);
            padding: 2px 7px;
            border-radius: 20px;
            font-size: 0.7rem;
        }

        .category-tab.active .count {
            background: rgba(255,255,255,0.25);
        }

        .course-list-container {
            flex: 1;
            overflow-y: auto;
            padding-right: 8px;
            max-height: calc(100vh - 380px);
        }

        .category-section {
            margin-bottom: 20px;
        }

        .category-header {
            position: sticky;
            top: 0;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 10px 16px;
            border-radius: 10px;
            margin-bottom: 12px;
            font-weight: 600;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .category-header.food-savory { background: linear-gradient(135deg, var(--category-food-savory) 0%, #d84315 100%); }
        .category-header.food-sweet { background: linear-gradient(135deg, var(--category-food-sweet) 0%, #c2185b 100%); }
        .category-header.development { background: linear-gradient(135deg, var(--category-development) 0%, #1976d2 100%); }
        .category-header.craft { background: linear-gradient(135deg, var(--category-craft) 0%, #6a1b9a 100%); }
        .category-header.agriculture { background: linear-gradient(135deg, var(--category-agriculture) 0%, #388e3c 100%); }
        .category-header.health { background: linear-gradient(135deg, var(--category-health) 0%, #0097a7 100%); }

        .category-header .course-count {
            background: rgba(255,255,255,0.25);
            padding: 2px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            margin-left: auto;
        }

        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
            gap: 12px;
        }

        .course-card {
            background: #fafafa;
            border-radius: 10px;
            padding: 14px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            display: flex;
            gap: 10px;
            align-items: flex-start;
        }

        .course-card:hover {
            border-color: var(--primary-light);
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px var(--shadow);
        }

        .course-card.selected {
            border-color: var(--selected-border);
            border-width: 3px;
            background: var(--selected-bg);
            box-shadow: 0 4px 16px rgba(46, 125, 50, 0.25);
        }

        .course-card.selected .course-name {
            color: var(--success);
            font-weight: 700;
        }

        .course-card.selected::before {
            content: "‚úì";
            position: absolute;
            top: -8px;
            left: -8px;
            width: 28px;
            height: 28px;
            background: var(--success);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .course-card.selected::after {
            content: attr(data-rank);
            position: absolute;
            top: -8px;
            right: -8px;
            min-width: 28px;
            height: 28px;
            padding: 0 8px;
            background: var(--accent);
            color: white;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .course-number {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .course-card.selected .course-number {
            background: var(--success);
        }

        .course-info {
            flex: 1;
            min-width: 0;
        }

        .course-name {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 4px;
            color: var(--text-dark);
        }

        .course-category {
            font-size: 0.75rem;
            padding: 3px 8px;
            border-radius: 20px;
            display: inline-block;
        }

        .course-category.food-savory {
            background: rgba(191, 54, 12, 0.1);
            color: var(--category-food-savory);
        }

        .course-category.food-sweet {
            background: rgba(173, 20, 87, 0.1);
            color: var(--category-food-sweet);
        }

        .course-category.development {
            background: rgba(21, 101, 192, 0.1);
            color: var(--category-development);
        }

        .course-category.craft {
            background: rgba(74, 20, 140, 0.1);
            color: var(--category-craft);
        }

        .course-category.agriculture {
            background: rgba(46, 125, 50, 0.1);
            color: var(--category-agriculture);
        }

        .course-category.health {
            background: rgba(0, 131, 143, 0.1);
            color: var(--category-health);
        }

        .course-category.custom {
            background: rgba(120, 144, 156, 0.15);
            color: var(--category-custom);
        }

        .rank-selector {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            align-items: center;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .course-card:hover .rank-selector,
        .course-card.selected .rank-selector {
            opacity: 1;
        }

        .rank-selector label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .rank-selector select {
            padding: 4px 8px;
            border-radius: 6px;
            border: 2px solid var(--primary);
            font-family: inherit;
            font-size: 0.75rem;
            cursor: pointer;
            background: white;
        }

        .custom-course-section {
            background: #f5f5f5;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            padding: 14px 16px;
            margin-top: 16px;
        }

        .custom-course-title {
            font-weight: 500;
            color: var(--category-custom);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
        }

        .custom-course-title::before {
            content: "‚úèÔ∏è";
            font-size: 0.9rem;
        }

        .custom-course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 8px;
        }

        .custom-input-wrapper {
            position: relative;
        }

        .custom-input-wrapper input {
            width: 100%;
            padding: 8px 12px 8px 30px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.85rem;
            transition: all 0.3s;
            background: white;
        }

        .custom-input-wrapper input::placeholder {
            color: #aaa;
            font-size: 0.8rem;
        }

        .custom-input-wrapper input:focus {
            outline: none;
            border-color: var(--category-custom);
            box-shadow: 0 0 0 2px rgba(120, 144, 156, 0.2);
        }

        .custom-input-wrapper input.has-value {
            border-color: var(--success);
            background: rgba(46, 125, 50, 0.05);
        }

        .custom-input-wrapper .input-number {
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            background: var(--category-custom);
            color: white;
            border-radius: 50%;
            font-size: 0.65rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
        }

        .submit-section {
            margin-top: 20px;
            padding-top: 16px;
            border-top: 2px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .progress-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .progress-bar {
            width: 180px;
            height: 10px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success) 0%, var(--success-light) 100%);
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        .progress-text {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.9rem;
        }

        .btn-submit {
            padding: 12px 32px;
            background: linear-gradient(135deg, var(--success) 0%, var(--success-light) 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 14px rgba(46, 125, 50, 0.3);
        }

        .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(46, 125, 50, 0.4);
        }

        .btn-submit:disabled {
            background: #ccc;
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn-submit.loading {
            background: #999;
            cursor: wait;
        }

        .btn-clear {
            padding: 10px 20px;
            background: white;
            color: var(--accent);
            border: 2px solid var(--accent);
            border-radius: 10px;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-clear:hover {
            background: var(--accent);
            color: white;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #f0f0f0;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-light);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary);
        }

        .toast {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: var(--primary);
            color: white;
            padding: 14px 20px;
            border-radius: 10px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            font-weight: 500;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.4s ease;
            z-index: 1000;
            font-size: 0.9rem;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.success {
            background: var(--success);
        }

        .toast.warning {
            background: var(--accent);
        }

        .toast.error {
            background: #d32f2f;
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
            }

            .left-panel {
                position: relative;
                top: 0;
                max-height: 350px;
            }

            .course-list-container {
                max-height: 500px;
            }
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
            }

            .header h1 {
                font-size: 1.3rem;
            }

            .main-container {
                padding: 12px;
            }

            .course-grid {
                grid-template-columns: 1fr;
            }

            .custom-course-grid {
                grid-template-columns: 1fr;
            }
        }

        .course-card.dragging {
            opacity: 0.5;
            transform: scale(0.98);
        }

        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }

        .loading-overlay.show {
            display: flex;
        }

        .loading-content {
            background: white;
            padding: 40px 60px;
            border-radius: 16px;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 1.1rem;
            color: var(--text-dark);
            font-weight: 500;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <h1>‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ ‡∏™‡∏Å‡∏£.</h1>
            <div class="header-stats">
                <div class="stat-badge">
                    ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß <strong id="selectedCount">0</strong> / 20
                </div>
                <div class="center-select">
                    <label>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô:</label>
                    <select id="centerSelect" required>
                        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå --</option>
                        <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡∏õ‡∏¥">‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏ö‡∏≤‡∏á‡∏Å‡∏∞‡∏õ‡∏¥</option>
                        <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏£‡πâ‡∏≤‡∏ß">‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏•‡∏≤‡∏î‡∏û‡∏£‡πâ‡∏≤‡∏ß</option>
                        <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á">‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏´‡πâ‡∏ß‡∏¢‡∏Ç‡∏ß‡∏≤‡∏á</option>
                        <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏ß‡∏±‡∏á‡∏ó‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏á">‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏ß‡∏±‡∏á‡∏ó‡∏≠‡∏á‡∏´‡∏•‡∏≤‡∏á</option>
                        <option value="‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏ö‡∏∂‡∏á‡∏Å‡∏∏‡πà‡∏°">‡∏®‡∏π‡∏ô‡∏¢‡πå ‡∏™‡∏Å‡∏£. ‡πÄ‡∏Ç‡∏ï‡∏ö‡∏∂‡∏á‡∏Å‡∏∏‡πà‡∏°</option>
                    </select>
                </div>
            </div>
        </div>
    </header>

    <main class="main-container">
        <aside class="left-panel">
            <h2 class="panel-title">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å (1-20)</h2>
            <div class="instructions">
                <strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</strong>
                <ul>
                    <li>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏Ç‡∏ß‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</li>
                    <li>‡∏•‡∏≤‡∏Å (Drag) ‡∏ß‡∏¥‡∏ä‡∏≤‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á</li>
                    <li>‡∏•‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏•‡∏±‡∏ö‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö / ‡∏Å‡∏î ‚úï ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏ö</li>
                    <li>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ 5 ‡∏ß‡∏¥‡∏ä‡∏≤ (‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á)</li>
                </ul>
            </div>
            <div class="ranking-list" id="rankingList"></div>
        </aside>

        <section class="right-panel">
            <div class="filter-bar">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£...">
                </div>
                <div class="category-tabs">
                    <button class="category-tab active" data-category="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span class="count" id="countAll">107</span></button>
                    <button class="category-tab" data-category="food-savory">üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏≤‡∏ß</button>
                    <button class="category-tab" data-category="food-sweet">üç∞ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ß‡∏≤‡∏ô</button>
                    <button class="category-tab" data-category="development">üìà ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏ô‡πÄ‡∏≠‡∏á</button>
                    <button class="category-tab" data-category="craft">üé® ‡∏á‡∏≤‡∏ô‡∏ù‡∏µ‡∏°‡∏∑‡∏≠</button>
                    <button class="category-tab" data-category="agriculture">üå± ‡πÄ‡∏Å‡∏©‡∏ï‡∏£</button>
                    <button class="category-tab" data-category="health">üíö ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</button>
                </div>
            </div>

            <div class="course-list-container" id="courseListContainer"></div>

            <div class="custom-course-section">
                <div class="custom-course-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏á (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5 ‡∏ß‡∏¥‡∏ä‡∏≤)</div>
                <div class="custom-course-grid" id="customCourseGrid">
                    <div class="custom-input-wrapper">
                        <span class="input-number">1</span>
                        <input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c1">
                    </div>
                    <div class="custom-input-wrapper">
                        <span class="input-number">2</span>
                        <input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c2">
                    </div>
                    <div class="custom-input-wrapper">
                        <span class="input-number">3</span>
                        <input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c3">
                    </div>
                    <div class="custom-input-wrapper">
                        <span class="input-number">4</span>
                        <input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c4">
                    </div>
                    <div class="custom-input-wrapper">
                        <span class="input-number">5</span>
                        <input type="text" placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤..." data-custom-id="c5">
                    </div>
                </div>
            </div>

            <div class="submit-section">
                <div class="progress-info">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <span class="progress-text"><span id="progressPercent">0</span>% ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô</span>
                </div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn-clear" id="btnClear">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    <button class="btn-submit" id="btnSubmit" disabled>‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏° ‚úì</button>
                </div>
            </div>
        </section>
    </main>

    <div class="toast" id="toast"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <div class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
        </div>
    </div>

    <script>
        // ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ - ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Apps Script ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyxVtMJ1BWmmWILG9eE2vrITr_2y8cd2fBVy5H8SHfqMbARqcfwH3OrUqhvvug1mNJ8/exec';
        // ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: 'https://script.google.com/macros/s/AKfycbxxx.../exec'

        // Course Data (‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏° - ‡∏¢‡πà‡∏≠‡∏•‡∏á)
        const courses = [
            { id: 1, name: "‡πÅ‡∏Å‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏´‡∏ß‡∏≤‡∏ô‡πÑ‡∏Å‡πà", category: "food-savory" },
            { id: 2, name: "‡∏ú‡∏±‡∏î‡πÑ‡∏ó‡∏¢‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î", category: "food-savory" },
            { id: 3, name: "‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á‡∏ô‡πâ‡∏≥‡∏Ç‡πâ‡∏ô", category: "food-savory" },
            { id: 4, name: "‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î‡∏´‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà", category: "food-savory" },
            { id: 5, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏°‡∏±‡∏ô‡πÑ‡∏Å‡πà", category: "food-savory" },
            { id: 6, name: "‡πÅ‡∏Å‡∏á‡∏°‡∏±‡∏™‡∏°‡∏±‡πà‡∏ô‡πÑ‡∏Å‡πà", category: "food-savory" },
            { id: 7, name: "‡∏ú‡∏±‡∏î‡∏Å‡∏∞‡πÄ‡∏û‡∏£‡∏≤‡∏´‡∏°‡∏π‡∏™‡∏±‡∏ö", category: "food-savory" },
            { id: 8, name: "‡∏™‡πâ‡∏°‡∏ï‡∏≥‡πÑ‡∏ó‡∏¢", category: "food-savory" },
            { id: 9, name: "‡∏•‡∏≤‡∏ö‡∏´‡∏°‡∏π", category: "food-savory" },
            { id: 10, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏õ‡∏π", category: "food-savory" },
            { id: 11, name: "‡∏´‡∏°‡∏π‡∏™‡∏∞‡πÄ‡∏ï‡πä‡∏∞", category: "food-savory" },
            { id: 12, name: "‡πÅ‡∏Å‡∏á‡πÄ‡∏ú‡πá‡∏î‡πÄ‡∏õ‡πá‡∏î‡∏¢‡πà‡∏≤‡∏á", category: "food-savory" },
            { id: 13, name: "‡∏¢‡∏≥‡∏ß‡∏∏‡πâ‡∏ô‡πÄ‡∏™‡πâ‡∏ô", category: "food-savory" },
            { id: 14, name: "‡∏ï‡πâ‡∏°‡∏Ç‡πà‡∏≤‡πÑ‡∏Å‡πà", category: "food-savory" },
            { id: 15, name: "‡∏û‡∏∞‡πÅ‡∏ô‡∏á‡∏´‡∏°‡∏π", category: "food-savory" },
            { id: 16, name: "‡∏ú‡∏±‡∏î‡∏ã‡∏µ‡∏≠‡∏¥‡πä‡∏ß‡πÄ‡∏™‡πâ‡∏ô‡πÉ‡∏´‡∏ç‡πà", category: "food-savory" },
            { id: 17, name: "‡∏Å‡πã‡∏ß‡∏¢‡πÄ‡∏ï‡∏µ‡πã‡∏¢‡∏ß‡πÄ‡∏£‡∏∑‡∏≠", category: "food-savory" },
            { id: 18, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏´‡∏°‡∏Å‡πÑ‡∏Å‡πà", category: "food-savory" },
            { id: 19, name: "‡∏´‡∏≠‡∏¢‡∏ó‡∏≠‡∏î", category: "food-savory" },
            { id: 20, name: "‡πÑ‡∏Ç‡πà‡πÄ‡∏à‡∏µ‡∏¢‡∏ß‡∏õ‡∏π", category: "food-savory" },
            { id: 21, name: "‡πÅ‡∏Å‡∏á‡∏õ‡πà‡∏≤‡∏´‡∏°‡∏π", category: "food-savory" },
            { id: 22, name: "‡∏ú‡∏±‡∏î‡∏û‡∏£‡∏¥‡∏Å‡πÅ‡∏Å‡∏á‡∏´‡∏°‡∏π‡∏Å‡∏£‡∏≠‡∏ö", category: "food-savory" },
            { id: 23, name: "‡∏£‡∏≤‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏°‡∏π", category: "food-savory" },
            { id: 24, name: "‡∏Å‡πã‡∏ß‡∏¢‡∏à‡∏±‡πä‡∏ö", category: "food-savory" },
            { id: 25, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ã‡∏≠‡∏¢‡πÑ‡∏Å‡πà", category: "food-savory" },
            { id: 26, name: "‡∏ó‡∏≠‡∏á‡∏´‡∏¢‡∏≠‡∏î", category: "food-sweet" },
            { id: 27, name: "‡∏ù‡∏≠‡∏¢‡∏ó‡∏≠‡∏á", category: "food-sweet" },
            { id: 28, name: "‡∏ó‡∏≠‡∏á‡∏´‡∏¢‡∏¥‡∏ö", category: "food-sweet" },
            { id: 29, name: "‡∏•‡∏≠‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏Å‡∏∞‡∏ó‡∏¥", category: "food-sweet" },
            { id: 30, name: "‡∏ö‡∏±‡∏ß‡∏•‡∏≠‡∏¢‡πÑ‡∏Ç‡πà‡∏´‡∏ß‡∏≤‡∏ô", category: "food-sweet" },
            { id: 31, name: "‡∏Ç‡∏ô‡∏°‡∏Ñ‡∏£‡∏Å", category: "food-sweet" },
            { id: 32, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á", category: "food-sweet" },
            { id: 33, name: "‡∏™‡∏±‡∏á‡∏Ç‡∏¢‡∏≤‡∏ü‡∏±‡∏Å‡∏ó‡∏≠‡∏á", category: "food-sweet" },
            { id: 34, name: "‡∏Ç‡∏ô‡∏°‡∏ä‡∏±‡πâ‡∏ô", category: "food-sweet" },
            { id: 35, name: "‡∏ï‡∏∞‡πÇ‡∏Å‡πâ", category: "food-sweet" },
            { id: 36, name: "‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏ö‡∏ß‡∏ä‡∏ä‡∏µ", category: "food-sweet" },
            { id: 37, name: "‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å‡∏ö‡∏ß‡∏ä‡∏ä‡∏µ", category: "food-sweet" },
            { id: 38, name: "‡∏Ç‡∏ô‡∏°‡∏ñ‡πâ‡∏ß‡∏¢‡∏ü‡∏π", category: "food-sweet" },
            { id: 39, name: "‡∏Ç‡∏ô‡∏°‡πÄ‡∏õ‡∏µ‡∏¢‡∏Å‡∏õ‡∏π‡∏ô", category: "food-sweet" },
            { id: 40, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡∏ï‡πâ‡∏°‡∏°‡∏±‡∏î", category: "food-sweet" },
            { id: 41, name: "‡∏Ç‡∏ô‡∏°‡∏´‡∏°‡πâ‡∏≠‡πÅ‡∏Å‡∏á", category: "food-sweet" },
            { id: 42, name: "‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ö‡∏ô‡∏∂‡πà‡∏á", category: "food-sweet" },
            { id: 43, name: "‡πÑ‡∏≠‡∏®‡∏Å‡∏£‡∏µ‡∏°‡∏Å‡∏∞‡∏ó‡∏¥", category: "food-sweet" },
            { id: 44, name: "‡∏Ç‡πâ‡∏≤‡∏ß‡πÄ‡∏´‡∏ô‡∏µ‡∏¢‡∏ß‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô", category: "food-sweet" },
            { id: 45, name: "‡∏Ç‡∏ô‡∏°‡∏ö‡πâ‡∏≤‡∏ö‡∏¥‡πà‡∏ô", category: "food-sweet" },
            { id: 46, name: "‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", category: "development" },
            { id: 47, name: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "development" },
            { id: 48, name: "Microsoft Excel ‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏π‡∏á", category: "development" },
            { id: 49, name: "‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå", category: "development" },
            { id: 50, name: "‡∏Å‡∏≤‡∏£‡∏Ç‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏ú‡πà‡∏≤‡∏ô Facebook", category: "development" },
            { id: 51, name: "‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤", category: "development" },
            { id: 52, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ñ‡∏£‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡∏≠‡∏ô", category: "development" },
            { id: 53, name: "‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•", category: "development" },
            { id: 54, name: "‡∏†‡∏≤‡∏©‡∏≤‡∏à‡∏µ‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "development" },
            { id: 55, name: "‡∏Å‡∏≤‡∏£‡∏û‡∏π‡∏î‡πÉ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞", category: "development" },
            { id: 56, name: "‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏£‡∏à‡∏≤‡∏ï‡πà‡∏≠‡∏£‡∏≠‡∏á", category: "development" },
            { id: 57, name: "‡∏Å‡∏≤‡∏£‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡πÄ‡∏ß‡∏•‡∏≤", category: "development" },
            { id: 58, name: "‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î‡πÄ‡∏ä‡∏¥‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå", category: "development" },
            { id: 59, name: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏â‡∏•‡∏≤‡∏î‡∏ó‡∏≤‡∏á‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå", category: "development" },
            { id: 60, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à", category: "development" },
            { id: 61, name: "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ AI ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏ß‡∏±‡∏ô", category: "development" },
            { id: 62, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ YouTube Content", category: "development" },
            { id: 63, name: "‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö Canva", category: "development" },
            { id: 64, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Podcast", category: "development" },
            { id: 65, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Blog", category: "development" },
            { id: 66, name: "‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏Å‡∏≤‡∏´‡∏•‡∏µ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "development" },
            { id: 67, name: "‡∏†‡∏≤‡∏©‡∏≤‡∏ç‡∏µ‡πà‡∏õ‡∏∏‡πà‡∏ô‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "development" },
            { id: 68, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏ô‡∏±‡∏á", category: "craft" },
            { id: 69, name: "‡∏Å‡∏≤‡∏£‡∏ñ‡∏±‡∏Å‡πÇ‡∏Ñ‡∏£‡πÄ‡∏ä‡∏ï‡πå", category: "craft" },
            { id: 70, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏ú‡πâ‡∏≤", category: "craft" },
            { id: 71, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡∏Å‡∏ú‡πâ‡∏≤", category: "craft" },
            { id: 72, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö", category: "craft" },
            { id: 73, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏™‡∏ö‡∏π‡πà‡πÅ‡∏Æ‡∏ô‡∏î‡πå‡πÄ‡∏°‡∏î", category: "craft" },
            { id: 74, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏ó‡∏µ‡∏¢‡∏ô‡∏´‡∏≠‡∏°", category: "craft" },
            { id: 75, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏à‡∏≤‡∏Å‡∏ú‡πâ‡∏≤", category: "craft" },
            { id: 76, name: "‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏î‡∏†‡∏≤‡∏û‡∏™‡∏µ‡∏ô‡πâ‡∏≥", category: "craft" },
            { id: 77, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏û‡∏ß‡∏á‡∏´‡∏£‡∏µ‡∏î", category: "craft" },
            { id: 78, name: "‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ", category: "craft" },
            { id: 79, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô DIY ‡∏à‡∏≤‡∏Å‡πÑ‡∏°‡πâ", category: "craft" },
            { id: 80, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏°‡∏Ñ‡∏£‡∏≤‡πÄ‡∏°‡πà", category: "craft" },
            { id: 81, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ï‡∏∏‡πä‡∏Å‡∏ï‡∏≤‡∏ú‡πâ‡∏≤", category: "craft" },
            { id: 82, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Å‡∏£‡∏∞‡πÄ‡∏õ‡πã‡∏≤‡∏´‡∏ô‡∏±‡∏á‡πÅ‡∏ó‡πâ", category: "craft" },
            { id: 83, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏±‡πâ‡∏ô‡∏î‡∏¥‡∏ô‡πÄ‡∏ú‡∏≤", category: "craft" },
            { id: 84, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏£‡∏ã‡∏¥‡∏ô", category: "craft" },
            { id: 85, name: "‡∏Å‡∏≤‡∏£‡∏ß‡∏≤‡∏î‡∏†‡∏≤‡∏û‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•", category: "craft" },
            { id: 86, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡πÑ‡∏Æ‡πÇ‡∏î‡∏£‡πÇ‡∏õ‡∏ô‡∏¥‡∏Å‡∏™‡πå", category: "agriculture" },
            { id: 87, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏õ‡∏∏‡πã‡∏¢‡∏´‡∏°‡∏±‡∏Å‡∏ä‡∏µ‡∏ß‡∏†‡∏≤‡∏û", category: "agriculture" },
            { id: 88, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡πÑ‡∏Å‡πà‡πÑ‡∏Ç‡πà", category: "agriculture" },
            { id: 89, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏õ‡∏•‡∏≤‡∏™‡∏ß‡∏¢‡∏á‡∏≤‡∏°", category: "agriculture" },
            { id: 90, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ñ‡∏≤‡∏á", category: "agriculture" },
            { id: 91, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏™‡∏ß‡∏ô‡∏ú‡∏±‡∏Å", category: "agriculture" },
            { id: 92, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏≤‡∏∞‡πÄ‡∏´‡πá‡∏î", category: "agriculture" },
            { id: 93, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å‡πÑ‡∏°‡πâ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏õ‡∏£‡∏∞‡∏î‡∏±‡∏ö", category: "agriculture" },
            { id: 94, name: "‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏µ‡πâ‡∏¢‡∏á‡∏ú‡∏∂‡πâ‡∏á", category: "agriculture" },
            { id: 95, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå", category: "agriculture" },
            { id: 96, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£", category: "agriculture" },
            { id: 97, name: "‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏£‡∏£‡∏π‡∏õ‡∏ú‡∏•‡∏ú‡∏•‡∏¥‡∏ï‡πÄ‡∏Å‡∏©‡∏ï‡∏£", category: "agriculture" },
            { id: 98, name: "‡πÇ‡∏¢‡∏Ñ‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û", category: "health" },
            { id: 99, name: "‡∏Å‡∏≤‡∏£‡∏ô‡∏ß‡∏î‡πÅ‡∏ú‡∏ô‡πÑ‡∏ó‡∏¢", category: "health" },
            { id: 100, name: "‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û", category: "health" },
            { id: 101, name: "‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏", category: "health" },
            { id: 102, name: "‡∏Å‡∏≤‡∏£‡∏õ‡∏ê‡∏°‡∏û‡∏¢‡∏≤‡∏ö‡∏≤‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô", category: "health" },
            { id: 103, name: "‡πÇ‡∏†‡∏ä‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß", category: "health" },
            { id: 104, name: "‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏ö‡πâ‡∏≤‡∏ô", category: "health" },
            { id: 105, name: "‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢", category: "health" },
            { id: 106, name: "‡∏Å‡∏≤‡∏£‡∏ô‡∏ß‡∏î‡∏Å‡∏î‡∏à‡∏∏‡∏î", category: "health" },
            { id: 107, name: "‡∏Å‡∏≤‡∏£‡∏î‡∏π‡πÅ‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï", category: "health" }
        ];

        const categoryInfo = {
            'food-savory': { name: 'üçú ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Ñ‡∏≤‡∏ß', icon: 'üçú' },
            'food-sweet': { name: 'üç∞ ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏ß‡∏≤‡∏ô', icon: 'üç∞' },
            'development': { name: 'üìà ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏ï‡∏ô‡πÄ‡∏≠‡∏á', icon: 'üìà' },
            'craft': { name: 'üé® ‡∏á‡∏≤‡∏ô‡∏ù‡∏µ‡∏°‡∏∑‡∏≠', icon: 'üé®' },
            'agriculture': { name: 'üå± ‡πÄ‡∏Å‡∏©‡∏ï‡∏£', icon: 'üå±' },
            'health': { name: 'üíö ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û', icon: 'üíö' },
            'custom': { name: '‚úèÔ∏è ‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏≠‡∏á', icon: '‚úèÔ∏è' }
        };

        const categoryOrder = ['food-savory', 'food-sweet', 'development', 'craft', 'agriculture', 'health', 'custom'];

        let rankings = new Array(20).fill(null);
        let currentCategory = 'all';
        let searchQuery = '';
        let customCourses = [];
        let allCourses = [...courses];

        const rankingList = document.getElementById('rankingList');
        const courseListContainer = document.getElementById('courseListContainer');
        const searchInput = document.getElementById('searchInput');
        const selectedCountEl = document.getElementById('selectedCount');
        const progressFill = document.getElementById('progressFill');
        const progressPercent = document.getElementById('progressPercent');
        const btnSubmit = document.getElementById('btnSubmit');
        const btnClear = document.getElementById('btnClear');
        const toast = document.getElementById('toast');
        const loadingOverlay = document.getElementById('loadingOverlay');
        const customInputs = document.querySelectorAll('[data-custom-id]');

        function init() {
            renderRankings();
            renderCourses();
            setupEventListeners();
        }

        function renderRankings() {
            rankingList.innerHTML = '';
            for (let i = 0; i < 20; i++) {
                const slot = document.createElement('div');
                slot.className = `ranking-slot ${rankings[i] ? 'filled' : ''}`;
                slot.dataset.rank = i + 1;
                slot.draggable = !!rankings[i];

                const course = rankings[i] ? allCourses.find(c => c.id === rankings[i]) : null;

                slot.innerHTML = `
                    <div class="ranking-number">${i + 1}</div>
                    <div class="ranking-content">${course ? course.name : '‡∏ß‡πà‡∏≤‡∏á - ‡∏•‡∏≤‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤‡∏°‡∏≤‡∏ß‡∏≤‡∏á'}</div>
                    ${course ? '<button class="ranking-remove">‚úï</button>' : ''}
                `;

                if (rankings[i]) {
                    slot.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', JSON.stringify({ fromRank: i + 1, courseId: rankings[i] }));
                        slot.classList.add('dragging');
                    });
                    slot.addEventListener('dragend', () => slot.classList.remove('dragging'));
                }

                slot.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    slot.classList.add('drag-over');
                });
                slot.addEventListener('dragleave', () => slot.classList.remove('drag-over'));
                slot.addEventListener('drop', (e) => {
                    e.preventDefault();
                    slot.classList.remove('drag-over');
                    try {
                        const data = JSON.parse(e.dataTransfer.getData('text/plain'));
                        handleDrop(data, i + 1);
                    } catch (err) {}
                });

                const removeBtn = slot.querySelector('.ranking-remove');
                if (removeBtn) {
                    removeBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        removeFromRanking(i);
                    });
                }

                rankingList.appendChild(slot);
            }
        }

        function renderCourses() {
            courseListContainer.innerHTML = '';

            let filtered = allCourses.filter(c => {
                const matchCategory = currentCategory === 'all' || c.category === currentCategory;
                const matchSearch = c.name.toLowerCase().includes(searchQuery.toLowerCase());
                return matchCategory && matchSearch;
            });

            document.getElementById('countAll').textContent = allCourses.length;

            const grouped = {};
            filtered.forEach(course => {
                if (!grouped[course.category]) {
                    grouped[course.category] = [];
                }
                grouped[course.category].push(course);
            });

            categoryOrder.forEach(cat => {
                if (grouped[cat] && grouped[cat].length > 0) {
                    const section = document.createElement('div');
                    section.className = 'category-section';

                    const header = document.createElement('div');
                    header.className = `category-header ${cat}`;
                    header.innerHTML = `
                        ${categoryInfo[cat].name}
                        <span class="course-count">${grouped[cat].length} ‡∏ß‡∏¥‡∏ä‡∏≤</span>
                    `;
                    section.appendChild(header);

                    const grid = document.createElement('div');
                    grid.className = 'course-grid';

                    grouped[cat].forEach(course => {
                        const rankIndex = rankings.indexOf(course.id);
                        const isSelected = rankIndex !== -1;

                        const card = document.createElement('div');
                        card.className = `course-card ${isSelected ? 'selected' : ''}`;
                        card.draggable = true;
                        card.dataset.courseId = course.id;
                        if (isSelected) card.dataset.rank = `#${rankIndex + 1}`;

                        card.innerHTML = `
                            <div class="course-number">${course.id}</div>
                            <div class="course-info">
                                <div class="course-name">${course.name}</div>
                                <span class="course-category ${course.category}">${categoryInfo[course.category].name}</span>
                            </div>
                            <div class="rank-selector">
                                <label>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö:</label>
                                <select>
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</option>
                                    ${Array.from({length: 20}, (_, i) => `<option value="${i + 1}" ${rankIndex === i ? 'selected' : ''}>${i + 1}</option>`).join('')}
                                </select>
                            </div>
                        `;

                        card.addEventListener('dragstart', (e) => {
                            e.dataTransfer.setData('text/plain', JSON.stringify({ courseId: course.id }));
                            card.classList.add('dragging');
                        });
                        card.addEventListener('dragend', () => card.classList.remove('dragging'));

                        card.addEventListener('click', (e) => {
                            if (e.target.tagName === 'SELECT') return;
                            toggleCourseSelection(course.id);
                        });

                        const select = card.querySelector('select');
                        select.addEventListener('change', (e) => {
                            const rank = parseInt(e.target.value);
                            if (rank) assignToRank(course.id, rank);
                        });

                        grid.appendChild(card);
                    });

                    section.appendChild(grid);
                    courseListContainer.appendChild(section);
                }
            });
        }

        function handleDrop(data, targetRank) {
            const { courseId, fromRank } = data;
            const targetIndex = targetRank - 1;

            if (fromRank) {
                const fromIndex = fromRank - 1;
                const temp = rankings[targetIndex];
                rankings[targetIndex] = rankings[fromIndex];
                rankings[fromIndex] = temp;
            } else {
                const existingIndex = rankings.indexOf(courseId);
                if (existingIndex !== -1) {
                    const temp = rankings[targetIndex];
                    rankings[targetIndex] = courseId;
                    rankings[existingIndex] = temp;
                } else {
                    if (rankings[targetIndex]) {
                        for (let i = 19; i > targetIndex; i--) {
                            rankings[i] = rankings[i - 1];
                        }
                    }
                    rankings[targetIndex] = courseId;
                }
            }

            updateUI();
            showToast(`‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${targetRank} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢`, 'success');
        }

        function toggleCourseSelection(courseId) {
            const existingIndex = rankings.indexOf(courseId);
            if (existingIndex !== -1) {
                removeFromRanking(existingIndex);
            } else {
                const emptyIndex = rankings.findIndex(r => r === null);
                if (emptyIndex !== -1) {
                    rankings[emptyIndex] = courseId;
                    updateUI();
                    showToast(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${emptyIndex + 1}`, 'success');
                } else {
                    showToast('‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏£‡∏ö 20 ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡πÅ‡∏•‡πâ‡∏ß!', 'warning');
                }
            }
        }

        function assignToRank(courseId, rank) {
            const targetIndex = rank - 1;
            const existingIndex = rankings.indexOf(courseId);

            if (existingIndex !== -1) {
                const temp = rankings[targetIndex];
                rankings[targetIndex] = courseId;
                rankings[existingIndex] = temp;
            } else {
                if (rankings[targetIndex]) {
                    for (let i = 19; i > targetIndex; i--) {
                        if (!rankings[i] && rankings[i - 1]) {
                            rankings[i] = rankings[i - 1];
                            rankings[i - 1] = null;
                        }
                    }
                    for (let i = 19; i > targetIndex; i--) {
                        rankings[i] = rankings[i - 1];
                    }
                }
                rankings[targetIndex] = courseId;
            }

            updateUI();
            showToast(`‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö ${rank}`, 'success');
        }

        function removeFromRanking(index) {
            const course = allCourses.find(c => c.id === rankings[index]);
            rankings[index] = null;
            updateUI();
            if (course) showToast(`‡∏•‡∏ö "${course.name}" ‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß`);
        }

        function updateUI() {
            renderRankings();
            renderCourses();
            updateProgress();
        }

        function updateProgress() {
            const count = rankings.filter(r => r !== null).length;
            selectedCountEl.textContent = count;
            const percent = Math.round((count / 20) * 100);
            progressFill.style.width = `${percent}%`;
            progressPercent.textContent = percent;
            btnSubmit.disabled = count < 20;
        }

        function showToast(message, type = '') {
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            setTimeout(() => toast.classList.remove('show'), 2500);
        }

        function setupEventListeners() {
            searchInput.addEventListener('input', (e) => {
                searchQuery = e.target.value;
                renderCourses();
            });

            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    currentCategory = tab.dataset.category;
                    renderCourses();
                });
            });

            customInputs.forEach((input, idx) => {
                input.addEventListener('input', () => {
                    updateCustomCourses();
                    input.classList.toggle('has-value', input.value.trim() !== '');
                });
            });

            btnClear.addEventListener('click', () => {
                rankings = new Array(20).fill(null);
                customInputs.forEach(input => {
                    input.value = '';
                    input.classList.remove('has-value');
                });
                updateCustomCourses();
                updateUI();
                showToast('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß');
            });

            // üéØ Submit Button Event
            btnSubmit.addEventListener('click', handleSubmit);
        }

        function updateCustomCourses() {
            allCourses = allCourses.filter(c => c.category !== 'custom');
            customCourses = [];

            customInputs.forEach((input, idx) => {
                const name = input.value.trim();
                if (name) {
                    const customId = 1000 + idx;
                    customCourses.push({ id: customId, name, category: 'custom' });
                    allCourses.push({ id: customId, name, category: 'custom' });
                }
            });

            renderCourses();
        }

        // üì§ ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Sheets
        async function handleSubmit() {
            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô
            const center = document.getElementById('centerSelect').value;
            if (!center) {
                showToast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô', 'warning');
                return;
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÉ‡∏™‡πà URL ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
            if (GOOGLE_SCRIPT_URL === 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE') {
                showToast('‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà Google Apps Script URL ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î JavaScript', 'error');
                console.error('‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GOOGLE_SCRIPT_URL');
                return;
            }

            // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const timestamp = new Date().toLocaleString('th-TH', { timeZone: 'Asia/Bangkok' });
            const coursesSelected = rankings.map((id, idx) => {
                if (!id) return null;
                const course = allCourses.find(c => c.id === id);
                return {
                    rank: idx + 1,
                    courseId: id,
                    courseName: course ? course.name : '',
                    category: course ? course.category : ''
                };
            }).filter(c => c !== null);

            const formData = {
                timestamp: timestamp,
                center: center,
                totalSelected: coursesSelected.length,
                courses: coursesSelected,
                customCourses: customCourses.map(c => c.name),
                // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô column ‡πÅ‡∏¢‡∏Å (Rank 1-20)
                rank1: coursesSelected.find(c => c.rank === 1)?.courseName || '',
                rank2: coursesSelected.find(c => c.rank === 2)?.courseName || '',
                rank3: coursesSelected.find(c => c.rank === 3)?.courseName || '',
                rank4: coursesSelected.find(c => c.rank === 4)?.courseName || '',
                rank5: coursesSelected.find(c => c.rank === 5)?.courseName || '',
                rank6: coursesSelected.find(c => c.rank === 6)?.courseName || '',
                rank7: coursesSelected.find(c => c.rank === 7)?.courseName || '',
                rank8: coursesSelected.find(c => c.rank === 8)?.courseName || '',
                rank9: coursesSelected.find(c => c.rank === 9)?.courseName || '',
                rank10: coursesSelected.find(c => c.rank === 10)?.courseName || '',
                rank11: coursesSelected.find(c => c.rank === 11)?.courseName || '',
                rank12: coursesSelected.find(c => c.rank === 12)?.courseName || '',
                rank13: coursesSelected.find(c => c.rank === 13)?.courseName || '',
                rank14: coursesSelected.find(c => c.rank === 14)?.courseName || '',
                rank15: coursesSelected.find(c => c.rank === 15)?.courseName || '',
                rank16: coursesSelected.find(c => c.rank === 16)?.courseName || '',
                rank17: coursesSelected.find(c => c.rank === 17)?.courseName || '',
                rank18: coursesSelected.find(c => c.rank === 18)?.courseName || '',
                rank19: coursesSelected.find(c => c.rank === 19)?.courseName || '',
                rank20: coursesSelected.find(c => c.rank === 20)?.courseName || '',
                customCourse1: customCourses[0]?.name || '',
                customCourse2: customCourses[1]?.name || '',
                customCourse3: customCourses[2]?.name || '',
                customCourse4: customCourses[3]?.name || '',
                customCourse5: customCourses[4]?.name || ''
            };

            console.log('üì§ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', formData);

            // ‡πÅ‡∏™‡∏î‡∏á Loading
            loadingOverlay.classList.add('show');
            btnSubmit.disabled = true;
            btnSubmit.classList.add('loading');

            try {
                // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ Google Apps Script
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å! ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡πâ‡∏≤‡∏° domain ‡πÑ‡∏î‡πâ
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                // ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÉ‡∏ä‡πâ no-cors ‡∏à‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ response ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà error ‡πÅ‡∏™‡∏î‡∏á‡∏ß‡πà‡∏≤‡∏™‡πà‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                console.log('‚úÖ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                
                // ‡∏ã‡πà‡∏≠‡∏ô Loading
                loadingOverlay.classList.remove('show');
                btnSubmit.classList.remove('loading');

                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à
                showToast('‡∏™‡πà‡∏á‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ', 'success');

                // ‡∏£‡∏≠ 2 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
                setTimeout(() => {
                    rankings = new Array(20).fill(null);
                    customInputs.forEach(input => {
                        input.value = '';
                        input.classList.remove('has-value');
                    });
                    document.getElementById('centerSelect').value = '';
                    updateCustomCourses();
                    updateUI();
                    
                    showToast('‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡∏°‡πà', 'success');
                }, 2000);

            } catch (error) {
                console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
                loadingOverlay.classList.remove('show');
                btnSubmit.disabled = false;
                btnSubmit.classList.remove('loading');
                showToast('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
            }
        }

        init();
    </script>
</body>
</html>
